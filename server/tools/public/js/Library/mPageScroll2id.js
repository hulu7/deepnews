define(function(A,B,C){var b=jQuery=A("jquery"),w={scrollSpeed:1300,autoScrollSpeed:!0,scrollEasing:"easeInOutExpo",scrollingEasing:"easeInOutCirc",pageEndSmoothScroll:!0,layout:"vertical",offset:0,highlightSelector:!1,clickedClass:"mPS2id-clicked",targetClass:"mPS2id-target",highlightClass:"mPS2id-highlight",forceSingleHighlight:!1,keepHighlightUntilNext:!1,highlightByNextTarget:!1,disablePluginBelow:!1,clickEvents:!0,onStart:function(){},onComplete:function(){},defaultSelector:!1,live:!0},n,g,x,
u,r,y,l,q,m,t,z=0,v,p={init:function(c){c=b.extend(!0,{},w,c);b(document).data("mPS2id",c);g=b(document).data("mPS2id");this.selector||(this.each(function(){var a=b(this);a.hasClass("__mPS2id")||a.addClass("__mPS2id")}),this.selector=".__mPS2id");n=n?n+","+this.selector:this.selector;!g.defaultSelector||"object"===typeof b(n)&&0!==b(n).length||(n=".m_PageScroll2id,a[rel~='m_PageScroll2id'],.page-scroll-to-id,a[rel~='page-scroll-to-id'],._ps2id");g.clickEvents&&b(document).undelegate(".mPS2id").delegate(n,
"click.mPS2id",function(a){if(h._isDisabled.call(null))h._removeClasses.call(null);else{var c=b(this),d=c.attr("href"),f=c.prop("href");d&&-1!==d.indexOf("#/")||(h._reset.call(null),t=c.data("ps2id-offset")||0,h._isValid.call(null,d,f)&&h._findTarget.call(null,d)&&(a.preventDefault(),u="selector",r=c,h._setClasses.call(null,!0),h._scrollTo.call(null)))}});b(window).unbind(".mPS2id").bind("scroll.mPS2id resize.mPS2id",function(){if(h._isDisabled.call(null))h._removeClasses.call(null);else{var a=b("._mPS2id-t");
a.each(function(c){var d=b(this),f=d.attr("id"),f=h._findHighlight.call(null,f);h._setClasses.call(null,!1,d,f);c==a.length-1&&h._extendClasses.call(null)})}});x=!0;h._setup.call(null);h._live.call(null)},scrollTo:function(c,a){h._isDisabled.call(null)?h._removeClasses.call(null):c&&"undefined"!==typeof c&&(h._isInit.call(null),a=b.extend(!0,{},{layout:g.layout,offset:g.offset,clicked:!1},a),h._reset.call(null),q=a.layout,m=a.offset,c=-1!==c.indexOf("#")?c:"#"+c,h._isValid.call(null,c)&&h._findTarget.call(null,
c)&&(u="scrollTo",(r=a.clicked)&&h._setClasses.call(null,!0),h._scrollTo.call(null)))},destroy:function(){b(window).unbind(".mPS2id");b(document).undelegate(".mPS2id").removeData("mPS2id");b("._mPS2id-t").removeData("mPS2id");h._removeClasses.call(null,!0)}},h={_isDisabled:function(){var c=window,a="inner",e=g.disablePluginBelow instanceof Array?[g.disablePluginBelow[0]||0,g.disablePluginBelow[1]||0]:[g.disablePluginBelow||0,0];"innerWidth"in window||(a="client",c=document.documentElement||document.body);
return c[a+"Width"]<=e[0]||c[a+"Height"]<=e[1]},_isValid:function(c,a){if(c){a=a?a:c;var e=-1!==a.indexOf("#/")?a.split("#/")[0]:a.split("#")[0],d=window.location.toString().split("#")[0];return"#"!==c&&-1!==c.indexOf("#")&&(""===e||e===d)}},_setup:function(){var c=h._highlightSelector(),a=1,e=0;return b(c).each(function(){var d=b(this),f=d.attr("href"),k=d.prop("href");h._isValid.call(null,f,k)&&(k=-1!==f.indexOf("#/")?f.split("#/")[1]:f.split("#")[1],f=b("#"+k),0<f.length&&(g.highlightByNextTarget&&
f!==e&&(e?e.data("mPS2id",{tn:f}):f.data("mPS2id",{tn:"0"}),e=f),f.hasClass("_mPS2id-t")||f.addClass("_mPS2id-t"),f.data("mPS2id",{i:a}),d.hasClass("_mPS2id-h")||d.addClass("_mPS2id-h"),d=h._findHighlight.call(null,k),h._setClasses.call(null,!1,f,d),z=a,a++,a==b(c).length&&h._extendClasses.call(null)))})},_highlightSelector:function(){return g.highlightSelector&&""!==g.highlightSelector?g.highlightSelector:n},_findTarget:function(c){c=-1!==c.indexOf("#/")?c.split("#/")[1]:c.split("#")[1];var a=b("#"+
c);if(1>a.length||"fixed"===a.css("position"))if("top"===c)a=b("body");else return;y=a;q||(q=g.layout);m=h._setOffset.call(null);l=[(a.offset().top-m[0]).toString(),(a.offset().left-m[1]).toString()];l[0]=0>l[0]?0:l[0];l[1]=0>l[1]?0:l[1];return l},_setOffset:function(){m||(m=g.offset?g.offset:0);t&&(m=t);var c,a,e;switch(typeof m){case "object":case "string":c=[m.y?m.y:m,m.x?m.x:m];a=[c[0]instanceof jQuery?c[0]:b(c[0]),c[1]instanceof jQuery?c[1]:b(c[1])];0<a[0].length?(e=a[0].height(),"fixed"===a[0].css("position")&&
(e+=a[0][0].offsetTop)):e=!isNaN(parseFloat(c[0]))&&isFinite(c[0])?parseInt(c[0]):0;0<a[1].length?(c=a[1].width(),"fixed"===a[1].css("position")&&(c+=a[1][0].offsetLeft)):c=!isNaN(parseFloat(c[1]))&&isFinite(c[1])?parseInt(c[1]):0;break;case "function":c=m.call(null);c instanceof Array?(e=c[0],c=c[1]):e=c;break;default:e=c=parseInt(m)}return[e,c]},_findHighlight:function(c){var a=window.location.toString().split("#")[0],e=b("._mPS2id-h[href='#"+c+"']"),d=b("._mPS2id-h[href='"+a+"#"+c+"']"),f=b("._mPS2id-h[href='#/"+
c+"']");c=b("._mPS2id-h[href='"+a+"#/"+c+"']");e=0<e.length?e:d;f=0<f.length?f:c;return 0<f.length?f:e},_setClasses:function(c,a,e){var d=g.clickedClass,f=g.targetClass,k=g.highlightClass;if(c&&d&&""!==d)b("."+d).removeClass(d),r.addClass(d);else if(a&&f&&""!==f&&e&&k&&""!==k)if(h._currentTarget.call(null,a))a.addClass(f),e.addClass(k);else if(!g.keepHighlightUntilNext||1<b("."+k).length)a.removeClass(f),e.removeClass(k)},_extendClasses:function(){var c=g.targetClass,a=g.highlightClass,e=b("."+c),
d=b("."+a),f=c+"-first",k=c+"-last",h=a+"-first",l=a+"-last";b("._mPS2id-t").removeClass(f+" "+k);b("._mPS2id-h").removeClass(h+" "+l);g.forceSingleHighlight?g.keepHighlightUntilNext&&1<e.length?(e.slice(0,1).removeClass(c),d.slice(0,1).removeClass(a)):(e.slice(1).removeClass(c),d.slice(1).removeClass(a)):(e.slice(0,1).addClass(f).end().slice(-1).addClass(k),d.slice(0,1).addClass(h).end().slice(-1).addClass(l))},_removeClasses:function(c){b("."+g.clickedClass).removeClass(g.clickedClass);b("."+g.targetClass).removeClass(g.targetClass+
" "+g.targetClass+"-first "+g.targetClass+"-last");b("."+g.highlightClass).removeClass(g.highlightClass+" "+g.highlightClass+"-first "+g.highlightClass+"-last");c&&(b("._mPS2id-t").removeClass("_mPS2id-t"),b("._mPS2id-h").removeClass("_mPS2id-h"))},_currentTarget:function(c){var a=g["target_"+c.data("mPS2id").i],e=c.data("ps2id-target"),d=e?b(e)[0].getBoundingClientRect():c[0].getBoundingClientRect();if("undefined"!==typeof a){var f=c.offset().top,e=c.offset().left;c=a.from?a.from+f:f;var k=a.fromX?
a.fromX+e:e,e=a.toX?a.toX+e:e;return d.top>=(a.to?a.to+f:f)&&d.top<=c&&d.left>=e&&d.left<=k}var a=b(window).height(),f=b(window).width(),k=e?b(e).height():c.height(),e=e?b(e).width():c.width(),h=1+k/a,l=1+e/f,k=[d.top<=a/h,d.bottom>=a/(k<a?a/k*h:h),d.left<=f/l,d.right>=f/(e<f?f/e*l:l)];g.highlightByNextTarget&&(c=c.data("mPS2id").tn)&&(c=c[0].getBoundingClientRect(),"vertical"===g.layout?k=[d.top<=a/2,c.top>a/2,1,1]:"horizontal"===g.layout&&(k=[1,1,d.left<=f/2,c.left>f/2]));return k[0]&&k[1]&&k[2]&&
k[3]},_scrollTo:function(){g.scrollSpeed=parseInt(g.scrollSpeed);l=g.pageEndSmoothScroll?h._pageEndSmoothScroll.call(null):l;var c=b("html,body"),a=g.autoScrollSpeed?h._autoScrollSpeed.call(null):g.scrollSpeed,e=c.is(":animated")?g.scrollingEasing:g.scrollEasing,d=b(window).scrollTop(),f=b(window).scrollLeft();switch(q){case "horizontal":f!=l[1]&&(h._callbacks.call(null,"onStart"),c.stop().animate({scrollLeft:l[1]},a,e).promise().then(function(){h._callbacks.call(null,"onComplete")}));break;case "auto":if(d!=
l[0]||f!=l[1])if(h._callbacks.call(null,"onStart"),navigator.userAgent.match(/(iPod|iPhone|iPad|Android)/)){var k;c.stop().animate({pageYOffset:l[0],pageXOffset:l[1]},{duration:a,easing:e,step:function(a,c){"pageXOffset"==c.prop?k=a:"pageYOffset"==c.prop&&window.scrollTo(k,a)}}).promise().then(function(){h._callbacks.call(null,"onComplete")})}else c.stop().animate({scrollTop:l[0],scrollLeft:l[1]},a,e).promise().then(function(){h._callbacks.call(null,"onComplete")});break;default:d!=l[0]&&(h._callbacks.call(null,
"onStart"),c.stop().animate({scrollTop:l[0]},a,e).promise().then(function(){h._callbacks.call(null,"onComplete")}))}},_pageEndSmoothScroll:function(){var c=b(document).height(),a=b(document).width(),e=b(window).height(),d=b(window).width();return[c-l[0]<e?c-e:l[0],a-l[1]<d?a-d:l[1]]},_autoScrollSpeed:function(){var c=b(window).scrollTop(),a=b(window).scrollLeft(),e=b(document).height(),d=b(document).width(),c=[g.scrollSpeed+g.scrollSpeed*Math.floor(Math.abs(l[0]-c)/e*100)/100,g.scrollSpeed+g.scrollSpeed*
Math.floor(Math.abs(l[1]-a)/d*100)/100];return Math.max.apply(Math,c)},_callbacks:function(c){if(g)switch(this.mPS2id={trigger:u,clicked:r,target:y,scrollTo:{y:l[0],x:l[1]}},c){case "onStart":g.onStart.call(null,this.mPS2id);break;case "onComplete":g.onComplete.call(null,this.mPS2id)}},_reset:function(){q=m=t=!1},_isInit:function(){x||p.init.apply(this)},_live:function(){v=setTimeout(function(){g.live?b(h._highlightSelector()).length!==z&&h._setup.call(null):v&&clearTimeout(v);h._live.call(null)},
1E3)},_easing:function(){b.easing.easeInQuad=b.easing.easeInQuad||function(c,a,e,d,b){return d*(a/=b)*a+e};b.easing.easeOutQuad=b.easing.easeOutQuad||function(c,a,e,d,b){return-d*(a/=b)*(a-2)+e};b.easing.easeInOutQuad=b.easing.easeInOutQuad||function(c,a,e,d,b){return 1>(a/=b/2)?d/2*a*a+e:-d/2*(--a*(a-2)-1)+e};b.easing.easeInCubic=b.easing.easeInCubic||function(c,a,e,d,b){return d*(a/=b)*a*a+e};b.easing.easeOutCubic=b.easing.easeOutCubic||function(c,a,e,d,b){return d*((a=a/b-1)*a*a+1)+e};b.easing.easeInOutCubic=
b.easing.easeInOutCubic||function(c,a,e,d,b){return 1>(a/=b/2)?d/2*a*a*a+e:d/2*((a-=2)*a*a+2)+e};b.easing.easeInQuart=b.easing.easeInQuart||function(c,a,e,d,b){return d*(a/=b)*a*a*a+e};b.easing.easeOutQuart=b.easing.easeOutQuart||function(c,a,e,b,f){return-b*((a=a/f-1)*a*a*a-1)+e};b.easing.easeInOutQuart=b.easing.easeInOutQuart||function(c,a,e,b,f){return 1>(a/=f/2)?b/2*a*a*a*a+e:-b/2*((a-=2)*a*a*a-2)+e};b.easing.easeInQuint=b.easing.easeInQuint||function(c,a,e,b,f){return b*(a/=f)*a*a*a*a+e};b.easing.easeOutQuint=
b.easing.easeOutQuint||function(c,a,b,d,f){return d*((a=a/f-1)*a*a*a*a+1)+b};b.easing.easeInOutQuint=b.easing.easeInOutQuint||function(c,a,b,d,f){return 1>(a/=f/2)?d/2*a*a*a*a*a+b:d/2*((a-=2)*a*a*a*a+2)+b};b.easing.easeInExpo=b.easing.easeInExpo||function(c,a,b,d,f){return 0==a?b:d*Math.pow(2,10*(a/f-1))+b};b.easing.easeOutExpo=b.easing.easeOutExpo||function(c,a,b,d,f){return a==f?b+d:d*(-Math.pow(2,-10*a/f)+1)+b};b.easing.easeInOutExpo=b.easing.easeInOutExpo||function(c,a,b,d,f){return 0==a?b:a==
f?b+d:1>(a/=f/2)?d/2*Math.pow(2,10*(a-1))+b:d/2*(-Math.pow(2,-10*--a)+2)+b};b.easing.easeInSine=b.easing.easeInSine||function(c,a,b,d,f){return-d*Math.cos(a/f*(Math.PI/2))+d+b};b.easing.easeOutSine=b.easing.easeOutSine||function(c,a,b,d,f){return d*Math.sin(a/f*(Math.PI/2))+b};b.easing.easeInOutSine=b.easing.easeInOutSine||function(c,a,b,d,f){return-d/2*(Math.cos(Math.PI*a/f)-1)+b};b.easing.easeInCirc=b.easing.easeInCirc||function(c,a,b,d,f){return-d*(Math.sqrt(1-(a/=f)*a)-1)+b};b.easing.easeOutCirc=
b.easing.easeOutCirc||function(c,a,b,d,f){return d*Math.sqrt(1-(a=a/f-1)*a)+b};b.easing.easeInOutCirc=b.easing.easeInOutCirc||function(c,a,b,d,f){return 1>(a/=f/2)?-d/2*(Math.sqrt(1-a*a)-1)+b:d/2*(Math.sqrt(1-(a-=2)*a)+1)+b};b.easing.easeInElastic=b.easing.easeInElastic||function(b,a,e,d,f){b=1.70158;var k=0,g=d;if(0==a)return e;if(1==(a/=f))return e+d;k||(k=.3*f);g<Math.abs(d)?(g=d,b=k/4):b=k/(2*Math.PI)*Math.asin(d/g);return-(g*Math.pow(2,10*--a)*Math.sin(2*(a*f-b)*Math.PI/k))+e};b.easing.easeOutElastic=
b.easing.easeOutElastic||function(b,a,e,d,f){b=1.70158;var k=0,g=d;if(0==a)return e;if(1==(a/=f))return e+d;k||(k=.3*f);g<Math.abs(d)?(g=d,b=k/4):b=k/(2*Math.PI)*Math.asin(d/g);return g*Math.pow(2,-10*a)*Math.sin(2*(a*f-b)*Math.PI/k)+d+e};b.easing.easeInOutElastic=b.easing.easeInOutElastic||function(b,a,e,d,f){b=1.70158;var k=0,g=d;if(0==a)return e;if(2==(a/=f/2))return e+d;k||(k=.3*f*1.5);g<Math.abs(d)?(g=d,b=k/4):b=k/(2*Math.PI)*Math.asin(d/g);return 1>a?-.5*g*Math.pow(2,10*--a)*Math.sin(2*(a*f-
b)*Math.PI/k)+e:g*Math.pow(2,-10*--a)*Math.sin(2*(a*f-b)*Math.PI/k)*.5+d+e};b.easing.easeInBack=b.easing.easeInBack||function(b,a,e,d,f,g){void 0==g&&(g=1.70158);return d*(a/=f)*a*((g+1)*a-g)+e};b.easing.easeOutBack=b.easing.easeOutBack||function(b,a,e,d,f,g){void 0==g&&(g=1.70158);return d*((a=a/f-1)*a*((g+1)*a+g)+1)+e};b.easing.easeInOutBack=b.easing.easeInOutBack||function(b,a,e,d,f,g){void 0==g&&(g=1.70158);return 1>(a/=f/2)?d/2*a*a*(((g*=1.525)+1)*a-g)+e:d/2*((a-=2)*a*(((g*=1.525)+1)*a+g)+2)+
e};b.easing.easeInBounce=b.easing.easeInBounce||function(c,a,e,d,f){return d-b.easing.easeOutBounce(c,f-a,0,d,f)+e};b.easing.easeOutBounce=b.easing.easeOutBounce||function(b,a,e,d,f){return(a/=f)<1/2.75?7.5625*d*a*a+e:a<2/2.75?d*(7.5625*(a-=1.5/2.75)*a+.75)+e:a<2.5/2.75?d*(7.5625*(a-=2.25/2.75)*a+.9375)+e:d*(7.5625*(a-=2.625/2.75)*a+.984375)+e};b.easing.easeInOutBounce=b.easing.easeInOutBounce||function(c,a,e,d,f){return a<f/2?.5*b.easing.easeInBounce(c,2*a,0,d,f)+e:.5*b.easing.easeOutBounce(c,2*
a-f,0,d,f)+.5*d+e}}};h._easing.call();b.fn.mPageScroll2id=function(c){if(p[c])return p[c].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof c&&c)b.error("Method "+c+" does not exist");else return p.init.apply(this,arguments)};b.mPageScroll2id=function(c){if(p[c])return p[c].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof c&&c)b.error("Method "+c+" does not exist");else return p.init.apply(this,arguments)};b.mPageScroll2id.defaults=w});