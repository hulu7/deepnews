define(function(a){function i(a,b){this.form=a,this.opts=d.extend(!0,{},d.fn[e].defaults,b),this._gatherValidation(),this._bindEvents(),this._bindCustomEvents(),this.addField(this.opts.validate.fields.filter(d(h,this.form)))}function j(a,b){this.field=a,this.form=b,this.originalValue=this.field.attr("value")||"",this._gatherValidations(),this._bindEvents(),this._bindCustomEvents(),this._init()}function k(a){return"undefined"!=typeof HTMLElement?a instanceof HTMLElement:a.nodeType&&a.nodeType==Node.ELEMENT_NODE}function l(a){return"string"==typeof a&&(a=a.split(" ")),a.join(".vv ")+".vv"}function m(a){return d.grep(a,function(b,c){return d.inArray(b,a)===c})}function n(a){var b,c;if(null===a)return"";if("object"==typeof a){b=[];for(c in a)b[c]=n(a[c]);return b}return"string"!=typeof a?"":0==a.length?"":a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function o(a){var b,c,d,e;if(null===a)return"";if("object"==typeof a){for(b in a)a[b]=o(a[b]);return a}if("string"!=typeof a)return"";if(0==a.length)return"";for(a=n(a),c=[" ","-","+","(",")","/","\\"],d=0,e=c.length;e>d;d++)a=a.split(c[d]).join("");return a}function p(a){switch(a){case 9:case 13:case 16:case 17:case 18:case 37:case 38:case 39:case 40:case 224:return!0;default:return!1}}var d=jQuery=a("jquery"),e="validVal",f="validValField",g="5.0.2",h='textarea, select, input:not( [type="button"], [type="submit"], [type="reset"] )';d.fn[e]||(i.prototype={addField:function(a){if((k(a)||"string"==typeof a)&&(a=d(a)),!(a instanceof d))return d.fn[e].debug('Not a valid argument for "$field"'),this;var b=this;return a.each(function(){var a=d(this),c=a.data(f);c&&c.destroy(),a.data(f,new j(a,b))})},validate:function(a,b){var e,g,c=this;return"undefined"==typeof a?(a=this.form,b=!0):"boolean"!=typeof b&&(b=!1),"function"==typeof this.opts.form.onValidate&&this.opts.form.onValidate.call(this.form[0],this.opts.language),e=d(),g={},this.opts.validate.fields.filter(d(h,a)).each(function(){var h,a=d(this),b=a.data(f);b&&(b.validate(c.opts.validate.onSubmit),b.valid?(h=a.val(),(a.is('[type="radio"]')||a.is('[type="checkbox"]'))&&(a.is(":checked")||(h="")),("undefined"==typeof h||null==h)&&(h=""),g[a.attr("name")]=h):c.opts.validate.onSubmit!==!1&&(e=e.add(a)))}),e.length>0?("function"==typeof this.opts.form.onInvalid&&b&&this.opts.form.onInvalid.call(this.form[0],e,this.opts.language),!1):("function"==typeof this.opts.form.onValid&&b&&this.opts.form.onValid.call(this.form[0],this.opts.language),g)},submitForm:function(){var a=this.validate();return a&&this.opts.validate.fields.filter(d(h,this.form)).each(function(){var a=d(this).data(f);a&&a.clearPlaceholderValue()}),a},resetForm:function(){return"function"==typeof this.opts.form.onReset&&this.opts.form.onReset.call(this.form[0],this.opts.language),this.opts.validate.fields.filter(d(h,this.form)).each(function(){var a=d(this),b=a.data(f);b&&(b.placeholderValue!==!1?(a.addClass("inactive"),a.val(b.placeholderValue)):a.val(b.originalValue),b.isValid(!0,!0))}),!0},options:function(a){return"object"==typeof a&&(this.opts=d.extend(this.opts,a)),this.opts},destroy:function(){return this.form.unbind(".vv"),this.form.data(e,null),this.opts.validate.fields.filter(d(h,this.form)).each(function(){var a=d(this).data(f);a&&a.destroy()}),!0},_gatherValidation:function(){return this.opts.validations={},d.fn[e].customValidations&&(this.opts.validations=d.extend(this.opts.validations,d.fn[e].customValidations)),this.opts.customValidations&&(this.opts.validations=d.extend(this.opts.validations,this.opts.customValidations)),this.opts.validations=d.extend(this.opts.validations,d.fn[e].defaultValidations),this},_bindEvents:function(){var a=this;return this.form.is("form")&&(this.form.attr("novalidate","novalidate"),this.form.bind(l("submit"),function(b,c){return"boolean"!=typeof c&&(c=!0),c?a.submitForm():!0}),this.form.bind(l("reset"),function(){return a.resetForm()})),this},_bindCustomEvents:function(){var a=this;return this.form.bind(l(["addField","destroy","validate","submitForm","resetForm","options"]),function(){arguments=Array.prototype.slice.call(arguments);var b=arguments.shift(),c=b.type;return b.stopPropagation(),"function"!=typeof a[c]?(d.fn.validVal.debug('Public method "'+c+'" not found.'),!1):a[c].apply(a,arguments)}),this}},j.prototype={validate:function(a,b){var g,i,j,k,l,c=this;if(a!==!1){if("boolean"!=typeof b&&(b=!0),this.valid=!0,this.field.is(":hidden")&&!this.form.opts.validate.fields.hidden||this.field.is(":disabled")&&!this.form.opts.validate.fields.disabled)return!0;b&&this.clearPlaceholderValue(),"function"==typeof this.form.opts.fields.onValidate&&this.form.opts.fields.onValidate.call(this.field[0],this.form.form,this.form.opts.language),g=!1,i=n(this.field.val());for(j in this.form.opts.validations)if(k=this.form.opts.validations[j],"function"==typeof k&&-1!=d.inArray(j,this.validations)&&!k.call(this.field[0],i)){g=j;break}return this.valid=g?!1:!0,l=this.valid?"invalid"!==a:"valid"!==a,this.isValid(this.valid,l,g),this.validationgroup!==!1&&d(h).not(this.field).each(function(){var a=d(this).data(f);a&&a.validationgroup==c.validationgroup&&a.isValid(c.valid,!0)}),b&&this.restorePlaceholderValue(),g&&d.fn[e].debug("invalid validation: "+g),this.valid}},isValid:function(a,b){if("boolean"==typeof a&&(this.valid=a,b)){var c=a?"onValid":"onInvalid";"function"==typeof this.form.opts.fields[c]&&this.form.opts.fields[c].call(this.field[0],this.form.form,this.form.opts.language)}return this.valid},getValidations:function(){return this.validations},setValidations:function(a){return"string"==typeof a?this.validations=a.split(" "):a instanceof Array?this.validations=a:d.fn.validVal.debug('Argument "validations" should be an array.'),this.validations},addValidation:function(a){"string"==typeof a&&(a=a.split(" "));for(var b in a)this.validations.push(a[b]);return this.validations},removeValidation:function(a){var b,c;"string"==typeof a&&(a=a.split(" "));for(b in a)c=d.inArray(a[b],this.validations),-1!=c&&this.validations.splice(c,1);return this.validations},clearPlaceholderValue:function(){return this._togglePlaceholderValue("clear"),!0},restorePlaceholderValue:function(){return this._togglePlaceholderValue("restore"),!0},destroy:function(){return this.field.unbind(".vv"),this.field.data(f,null),!0},_gatherValidations:function(){var a,b,c,f,g,h,i,j,k,l,n,o,p,q,r,s,t,u,v,w,x,y,z;if(this.autotab=!1,this.corresponding=!1,this.requiredgroup=!1,this.validationgroup=!1,this.placeholderValue=!1,this.placeholderNumber=!1,this.passwordplaceholder=!1,this.validations=[],this.field.is("select")?this.originalValue=this.field.find("option:first").attr("value")||"":this.field.is("textarea")&&(this.originalValue=this.field.text()),this.form.opts.supportHtml5){for(a=this.field.data("vv-validations"),a&&(this.validations.push(a),this.__removeAttr("data-vv-validations")),this.__hasHtml5Attr("placeholder")&&this.field.attr("placeholder").length>0&&(d.fn[e].support.placeholder&&-1!=d.inArray("placeholder",this.form.opts.keepAttributes)||(this.placeholderValue=this.field.attr("placeholder"))),this.placeholderValue!==!1&&this.__removeAttr("placeholder"),this.__hasHtml5Attr("pattern")&&this.field.attr("pattern").length>0&&(this.pattern=this.field.attr("pattern"),this.validations.push("pattern"),this.__removeAttr("pattern")),b=["corresponding","requiredgroup","validationgroup"],c=0,f=b.length;f>c;c++)g=this.field.data("vv-"+b[c]),g&&(this[b[c]]=g,this.validations.push(b[c]),this.__removeAttr("data-vv-"+b[c]));for(h=["required","autofocus"],i=0,f=h.length;f>i;i++)this.__hasHtml5Attr(h[i])&&(this.validations.push(h[i]),this.__removeAttr(h[i]));for(j=["number","email","url"],k=0,f=j.length;f>k;k++)this.__hasHtml5Type(j[k])&&this.validations.push(j[k]);this.field.data("vv-autotab")&&(this.autotab=!0,this.__removeAttr("data-vv-autotab"))}if(l=this.field.attr("class"),l&&l.length){for(this.field.hasClass("placeholder")&&(this.field.is("select")&&(n=0,o=this.field.data("vv-placeholder-number"),o?(n=o,this.__removeAttr("data-vv-placeholder-number")):"number"==typeof this.form.opts.selectPlaceholder?n=this.form.opts.selectPlaceholder:(p=this.field.find("option"),q=p.index(p.filter("[selected]")),q>-1&&(n=q)),this.placeholderNumber=n,this.originalValue=this.field.find("option:eq( "+n+" )").attr("value")||""),this.placeholderValue=this.originalValue,this.originalValue="",this.__removeClass("placeholder")),r="corresponding:",s=l.indexOf(r),-1!=s&&(t=l.substr(s).split(" ")[0],u=t.substr(r.length),u.length&&(this.corresponding=u,this.validations.push("corresponding"),this.field.removeClass(t))),this.field.hasClass("pattern")&&(this.pattern=this.field.attr("alt")||"",this.validations.push("pattern"),this.__removeAttr("alt"),this.__removeClass("pattern")),v=["requiredgroup","validationgroup"],w=0,f=v.length;f>w;w++)x=v[w]+":",s=l.indexOf(x),-1!=s&&(y=l.substr(s).split(" ")[0],z=y.substr(x.length),z.length&&(this[v[w]]=z,this.validations.push(v[w]),this.field.removeClass(y)));this.field.hasClass("autotab")&&(this.autotab=!0,this.__removeClass("autotab"))}return this.placeholderValue!==!1&&this.field.is('[type="password"]')&&(this.passwordplaceholder=!0),l=this.field.attr("class"),l&&l.length&&this.validations.push(l),this.validations=m(this.validations.join(" ").split(" ")),this},_bindEvents:function(){var a=this;return this.field.bind(l("focus"),function(){d(this).addClass("focus"),a.clearPlaceholderValue()}),this.field.bind(l("blur"),function(){d(this).removeClass("focus"),a.validate(a.form.opts.validate.onBlur)}),this.field.bind(l("keyup"),function(b){p(b.keyCode)||a.validate(a.form.opts.validate.onKeyup,!1)}),this.field.is('select, input[type="checkbox"], input[type="radio"]')&&this.field.bind(l("change"),function(){d(this).trigger(l("blur"))}),this},_bindCustomEvents:function(){var a=this;return this.field.bind(l(["validate","isValid","destroy","addValidation","removeValidation"]),function(){arguments=Array.prototype.slice.call(arguments);var b=arguments.shift(),c=b.type;return b.stopPropagation(),"function"!=typeof a[c]?(d.fn.validVal.debug('Public method "'+c+'" not found.'),!1):a[c].apply(a,arguments)}),this.field.bind(l(["validations"]),function(a,b,c){return"undefined"==typeof b?this.getValidations():this.setValidations(b,c)}),this},_init:function(){var c,e,f,a=this;if(this.placeholderValue!==!1){if(""==this.field.val()&&this.field.val(this.placeholderValue),this.passwordplaceholder&&this.field.val()==this.placeholderValue)try{this.field[0].type="text"}catch(b){}this.field.val()==this.placeholderValue&&this.field.addClass("inactive"),this.field.is("select")&&(this.field.find("option:eq("+this.placeholderNumber+")").addClass("inactive"),this.field.bind(l("change"),function(){d(this)[a.field.val()==a.placeholderValue?"addClass":"removeClass"]("inactive")}))}return this.corresponding!==!1&&d(h).filter('[name="'+this.corresponding+'"]').bind(l("blur"),function(){a.validate(a.form.opts.validate.onBlur)}).bind(l("keyup"),function(b){p(b.keyCode)||a.validate(a.form.opts.validate.onKeyup,!1)}),this.autotab&&(c=this.field.attr("maxlength"),e=this.field.attr("tabindex"),f=d(h).filter('[tabindex="'+(parseInt(e)+1)+'"]'),this.field.is("select")?e&&this.field.bind(l("change"),function(){f.length&&f.focus()}):c&&e&&this.field.bind(l("keyup"),function(a){d(this).val().length==c&&(p(a.keyCode)||(d(this).trigger(l("blur")),f.length&&f.focus()))})),-1==d.inArray("autofocus",this.validations)||this.field.is(":disabled")||this.field.focus(),this},_togglePlaceholderValue:function(a){var b,c,d,e;if(this.placeholderValue!==!1&&("clear"==a?(b=this.placeholderValue,c="",d="removeClass",e="password"):(b="",c=this.placeholderValue,d="addClass",e="text"),this.field.val()==b&&!this.field.is("select")&&(this.field.val(c),this.field[d]("inactive"),this.passwordplaceholder)))try{this.field[0].type=e}catch(f){}return this},__hasHtml5Attr:function(a){return"undefined"==typeof this.field.attr(a)?!1:"false"===this.field.attr(a)||this.field.attr(a)===!1?!1:!0},__hasHtml5Type:function(a){if(this.field.attr("type")==a)return!0;if(this.field.is('input[type="'+a+'"]'))return!0;var b=d("<div />").append(this.field.clone()).html();return-1!=b.indexOf('type="'+a+'"')||-1!=b.indexOf("type='"+a+"'")||-1!=b.indexOf("type="+a)?!0:!1},__removeAttr:function(a){return-1==d.inArray(a,this.form.opts.keepAttributes)&&this.field.removeAttr(a),this},__removeClass:function(a){return-1==d.inArray(a,this.form.opts.keepClasses)&&this.field.removeClass(a),this}},d.fn[e]=function(a,b){return this.each(function(){var c=d(this);c.data(e)&&c.data(e).destroy(),c.data(e,new i(c,a,b))})},d.fn[e].version=g,d.fn[e].defaults={selectPlaceholder:0,supportHtml5:!0,language:"en",customValidations:{},validate:{onBlur:!0,onSubmit:!0,onKeyup:!1,fields:{hidden:!1,disabled:!1,filter:function(a){return a}}},fields:{onValidate:null,onValid:function(){d(this).add(d(this).parent()).removeClass("invalid")},onInvalid:function(){d(this).add(d(this).parent()).addClass("invalid")}},form:{onReset:null,onValidate:null,onValid:null,onInvalid:function(a,b){switch(b){case"nl":msg="Let op, niet alle velden zijn correct ingevuld.";break;case"de":msg="Achtung, nicht alle Felder sind korrekt ausgefuellt.";break;case"es":msg="Atención, no se han completado todos los campos correctamente.";break;case"en":default:msg="Attention, not all fields have been filled out correctly."}alert(msg),a.first().focus()}},keepClasses:["required"],keepAttributes:["pattern","placeholder"]},d.fn[e].defaultValidations={required:function(a){var c,e,b=d(this);if(b.is('[type="radio"]')||b.is('[type="checkbox"]')){if(b.is('[type="radio"]')&&(c=b.attr("name"),c&&c.length>0&&(b=d('input[name="'+c+'"]'))),!b.is(":checked"))return!1}else if(b.is("select")){if(e=b.data(f),e&&e.placeholderValue!==!1){if(b.val()==e.placeholderValue)return!1}else if(0==a.length)return!1}else if(0==a.length)return!1;return!0},Required:function(a){return d.fn[e].defaultValidations.required.call(this,a)},requiredgroup:function(){var g,b=d(this),c=b.data(f);return c&&c.requiredgroup!==!1&&(b=d(),d(h).each(function(){var a=d(this).data(f);a&&a.requiredgroup==c.requiredgroup&&(b=b.add(this))})),g=!1,b.each(function(){var a=this;d.fn[e].defaultValidations.required.call(a,n(d(a).val()))&&(g=!0)}),g},corresponding:function(a){var e,b="",c=d(this).data(f);return c&&c.corresponding!==!1?(e=d(h).filter('[name="'+c.corresponding+'"]'),c=e.data(f),c&&(c.clearPlaceholderValue(),b=n(e.val()),c.restorePlaceholderValue()),a==b):!1},number:function(a){return a=o(a),0==a.length?!0:isNaN(a)?!1:!0},email:function(a){if(0==a.length)return!0;var b=/^([a-zA-Z0-9_\.\-+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;return b.test(a)},url:function(a){return 0==a.length?!0:(a.match(/^www\./)&&(a="http://"+a),a.match(/^(http\:\/\/|https\:\/\/)(.{4,})$/))},pattern:function(a){var b,c,e;return 0==a.length?!0:(b=d(this),c=b.data(f),c?(e=c.pattern,"/"==e.slice(0,1)&&(e=e.slice(1)),"/"==e.slice(-1)&&(e=e.slice(0,-1)),new RegExp(e).test(a)):void 0)}},d.fn[e].support={touch:function(){return"ontouchstart"in document.documentElement}(),placeholder:function(){return"placeholder"in document.createElement("input")}()},d.fn[e].debug=function(){},d.fn[e].deprecated=function(a,b){"undefined"!=typeof console&&"undefined"!=typeof console.error&&console.error(a+" is DEPRECATED, use "+b+" instead.")},d.fn.validValDebug||(d.fn.validValDebug=function(){return d.fn[e].debug("validVal debugger not installed!"),this}))});