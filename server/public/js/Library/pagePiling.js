define(function(t,R,S){var b=jQuery=t("jquery");b.fn.pagepiling=function(t){function H(a){var e=b(".pp-section.active").index(".pp-section");a=a.index(".pp-section");return e>a?"up":"down"}function h(a,e){var d={destination:a,animated:e,activeSection:b(".pp-section.active"),anchorLink:a.data("anchor"),sectionIndex:a.index(".pp-section"),toMove:a,yMovement:H(a),leavingSection:b(".pp-section.active").index(".pp-section")+1};d.activeSection.is(a)||("undefined"===typeof d.animated&&(d.animated=!0),"undefined"!==
typeof d.anchorLink&&I(d.anchorLink,d.sectionIndex),d.destination.addClass("active").siblings().removeClass("active"),d.sectionsToMove=J(d),"down"===d.yMovement?(d.translate3d="vertical"!==c.direction?"translate3d(-100%, 0px, 0px)":"translate3d(0px, -100%, 0px)",d.scrolling="-100%",c.css3||d.sectionsToMove.each(function(a){a!=d.activeSection.index(".pp-section")&&b(this).css(r(d.scrolling))}),d.animateSection=d.activeSection):(d.translate3d="translate3d(0px, 0px, 0px)",d.scrolling="0",d.animateSection=
a),b.isFunction(c.onLeave)&&c.onLeave.call(this,d.leavingSection,d.sectionIndex+1,d.yMovement),K(d),L(d.anchorLink),M(d.anchorLink,d.sectionIndex),x=d.anchorLink,y=(new Date).getTime())}function K(a){c.css3?(z(a.animateSection,a.translate3d,a.animated),a.sectionsToMove.each(function(){z(b(this),a.translate3d,a.animated)}),setTimeout(function(){u(a)},c.scrollingSpeed)):(a.scrollOptions=r(a.scrolling),a.animated?a.animateSection.animate(a.scrollOptions,c.scrollingSpeed,c.easing,function(){A(a);u(a)}):
(a.animateSection.css(r(a.scrolling)),setTimeout(function(){A(a);u(a)},400)))}function u(a){b.isFunction(c.afterLoad)&&c.afterLoad.call(this,a.anchorLink,a.sectionIndex+1)}function J(a){return"down"===a.yMovement?b(".pp-section").map(function(e){if(e<a.destination.index(".pp-section"))return b(this)}):b(".pp-section").map(function(e){if(e>a.destination.index(".pp-section"))return b(this)})}function A(a){"up"===a.yMovement&&a.sectionsToMove.each(function(e){b(this).css(r(a.scrolling))})}function r(a){return"vertical"===
c.direction?{top:a}:{left:a}}function I(a,b){c.anchors.length?(location.hash=a,B(location.hash)):B(String(b))}function B(a){a=a.replace("#","");b("body")[0].className=b("body")[0].className.replace(/\b\s?pp-viewing-[^\s]+\b/g,"");b("body").addClass("pp-viewing-"+a)}function v(){return(new Date).getTime()-y<600+c.scrollingSpeed?!0:!1}function z(a,b,c){a.toggleClass("pp-easing",c);a.css({"-webkit-transform":b,"-moz-transform":b,"-ms-transform":b,transform:b})}function k(a){if(!v()){a=window.event||
a;a=Math.max(-1,Math.min(1,a.wheelDelta||-a.deltaY||-a.detail));var e=b(".pp-section.active").filter(".pp-scrollable");0>a?l("down",e):l("up",e);return!1}}function l(a,b){var c,g;"down"==a?(c="bottom",g=f.moveSectionDown):(c="top",g=f.moveSectionUp);if(0<b.length)if(c="top"===c?!b.scrollTop():"bottom"===c?b.scrollTop()+1+b.innerHeight()>=b[0].scrollHeight:void 0,c)g();else return!0;else g()}function C(){return window.PointerEvent?{down:"pointerdown",move:"pointermove",up:"pointerup"}:{down:"MSPointerDown",
move:"MSPointerMove",up:"MSPointerUp"}}function D(a){var b=[];b.y="undefined"!==typeof a.pageY&&(a.pageY||a.pageX)?a.pageY:a.touches[0].pageY;b.x="undefined"!==typeof a.pageX&&(a.pageY||a.pageX)?a.pageX:a.touches[0].pageX;return b}function E(a){return"undefined"===typeof a.pointerType||"mouse"!=a.pointerType}function N(a){a=a.originalEvent;E(a)&&(a=D(a),m=a.y,n=a.x)}function O(a){var e=a.originalEvent;!F(a.target)&&E(e)&&(a.preventDefault(),a=b(".pp-section.active").filter(".pp-scrollable"),v()||
(e=D(e),p=e.y,q=e.x,"horizontal"===c.direction&&Math.abs(n-q)>Math.abs(m-p)?Math.abs(n-q)>g.width()/100*c.touchSensitivity&&(n>q?l("down",a):q>n&&l("up",a)):Math.abs(m-p)>g.height()/100*c.touchSensitivity&&(m>p?l("down",a):p>m&&l("up",a))))}function F(a,e){e=e||0;var d=b(a).parent();return e<c.normalScrollElementTouchThreshold&&d.is(c.normalScrollElements)?!0:e==c.normalScrollElementTouchThreshold?!1:F(d,++e)}function P(){b("body").append('<div id="pp-nav"><ul></ul></div>');var a=b("#pp-nav");a.css("color",
c.navigation.textColor);a.addClass(c.navigation.position);for(var e=0;e<b(".pp-section").length;e++){var d="";c.anchors.length&&(d=c.anchors[e]);if("undefined"!==c.navigation.tooltips){var f=c.navigation.tooltips[e];"undefined"===typeof f&&(f="")}a.find("ul").append('<li data-tooltip="'+f+'"><a href="#'+d+'"><span></span></a></li>')}a.find("span").css("border-color",c.navigation.bulletsColor)}function M(a,e){c.navigation&&(b("#pp-nav").find(".active").removeClass("active"),a?b("#pp-nav").find('a[href="#'+
a+'"]').addClass("active"):b("#pp-nav").find("li").eq(e).find("a").addClass("active"))}function L(a){c.menu&&(b(c.menu).find(".active").removeClass("active"),b(c.menu).find('[data-menuanchor="'+a+'"]').addClass("active"))}function Q(){var a=document.createElement("p"),b,c={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(a,null);for(var f in c)void 0!==a.style[f]&&(a.style[f]="translate3d(1px,1px,1px)",
b=window.getComputedStyle(a).getPropertyValue(c[f]));document.body.removeChild(a);return void 0!==b&&0<b.length&&"none"!==b}var f=b.fn.pagepiling,g=b(this),x,y=0,G="ontouchstart"in window||0<navigator.msMaxTouchPoints||navigator.maxTouchPoints,m=0,n=0,p=0,q=0,c=b.extend(!0,{direction:"vertical",menu:null,verticalCentered:!0,sectionsColor:[],anchors:[],scrollingSpeed:700,easing:"easeInQuart",loopBottom:!1,loopTop:!1,css3:!0,navigation:{textColor:"#000",bulletsColor:"#000",position:"right",tooltips:[]},
normalScrollElements:null,normalScrollElementTouchThreshold:5,touchSensitivity:5,keyboardScrolling:!0,sectionSelector:".section",animateAnchor:!1,afterLoad:null,onLeave:null,afterRender:null},t);b.extend(b.easing,{easeInQuart:function(a,b,c,f,g){return f*(b/=g)*b*b*b+c}});f.setScrollingSpeed=function(a){c.scrollingSpeed=a};f.setMouseWheelScrolling=function(a){a?g.get(0).addEventListener?(g.get(0).addEventListener("mousewheel",k,!1),g.get(0).addEventListener("wheel",k,!1)):g.get(0).attachEvent("onmousewheel",
k):g.get(0).addEventListener?(g.get(0).removeEventListener("mousewheel",k,!1),g.get(0).removeEventListener("wheel",k,!1)):g.get(0).detachEvent("onmousewheel",k)};f.setAllowScrolling=function(a){a?(f.setMouseWheelScrolling(!0),G&&(a=C(),g.off("touchstart "+a.down).on("touchstart "+a.down,N),g.off("touchmove "+a.move).on("touchmove "+a.move,O))):(f.setMouseWheelScrolling(!1),G&&(a=C(),g.off("touchstart "+a.down),g.off("touchmove "+a.move)))};f.setKeyboardScrolling=function(a){c.keyboardScrolling=a};
f.moveSectionUp=function(){var a=b(".pp-section.active").prev(".pp-section");!a.length&&c.loopTop&&(a=b(".pp-section").last());a.length&&h(a)};f.moveSectionDown=function(){var a=b(".pp-section.active").next(".pp-section");!a.length&&c.loopBottom&&(a=b(".pp-section").first());a.length&&h(a)};f.moveTo=function(a){var c="",c=isNaN(a)?b('[data-anchor="'+a+'"]'):b(".pp-section").eq(a-1);0<c.length&&h(c)};b(c.sectionSelector).each(function(){b(this).addClass("pp-section")});c.css3&&(c.css3=Q());b(g).css({overflow:"hidden",
"-ms-touch-action":"none","touch-action":"none"});f.setAllowScrolling(!0);b.isEmptyObject(c.navigation)||P();var w=b(".pp-section").length;b(".pp-section").each(function(a){b(this).data("data-index",a);b(this).css("z-index",w);a||0!==b(".pp-section.active").length||b(this).addClass("active");"undefined"!==typeof c.anchors[a]&&b(this).attr("data-anchor",c.anchors[a]);"undefined"!==typeof c.sectionsColor[a]&&b(this).css("background-color",c.sectionsColor[a]);c.verticalCentered&&!b(this).hasClass("pp-scrollable")&&
b(this).addClass("pp-table").wrapInner('<div class="pp-tableCell" style="height:100%" />');--w}).promise().done(function(){c.navigation&&(b("#pp-nav").css("margin-top","-"+b("#pp-nav").height()/2+"px"),b("#pp-nav").find("li").eq(b(".pp-section.active").index(".pp-section")).find("a").addClass("active"));b(window).on("load",function(){var a=window.location.hash.replace("#",""),a=b('.pp-section[data-anchor="'+a+'"]');0<a.length&&h(a,c.animateAnchor)});b.isFunction(c.afterRender)&&c.afterRender.call(this)});
b(window).on("hashchange",function(){var a=window.location.hash.replace("#","").split("/")[0];a.length&&a&&a!==x&&(a=isNaN(a)?b('[data-anchor="'+a+'"]'):b(".pp-section").eq(a-1),h(a))});b(document).keydown(function(a){if(c.keyboardScrolling&&!v())switch(a.which){case 38:case 33:f.moveSectionUp();break;case 40:case 34:f.moveSectionDown();break;case 36:f.moveTo(1);break;case 35:f.moveTo(b(".pp-section").length);break;case 37:f.moveSectionUp();break;case 39:f.moveSectionDown()}});c.normalScrollElements&&
(b(document).on("mouseenter",c.normalScrollElements,function(){f.setMouseWheelScrolling(!1)}),b(document).on("mouseleave",c.normalScrollElements,function(){f.setMouseWheelScrolling(!0)}));b(document).on("click touchstart","#pp-nav a",function(a){a.preventDefault();a=b(this).parent().index();h(b(".pp-section").eq(a))});b(document).on({mouseenter:function(){var a=b(this).data("tooltip");b('<div class="pp-tooltip '+c.navigation.position+'">'+a+"</div>").hide().appendTo(b(this)).fadeIn(200)},mouseleave:function(){b(this).find(".pp-tooltip").fadeOut(200,
function(){b(this).remove()})}},"#pp-nav li")}});